package ro.barata.mps.boLanguage.sandbox;

/*Generated by MPS */

import java.sql.Statement;
import java.sql.SQLException;

public class SchemaGenerator {

  private static void generateTables(Statement stmt) throws SQLException, ClassNotFoundException {
    String sql = "";
    String primaryKey = "";

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "categories" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    sql += "categoryId" + " " + "integer" + ",";
    sql += "categories" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "products" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    sql += "description" + " " + "varchar(256)" + ",";
    sql += "units" + " " + "integer" + ",";
    sql += "price" + " " + "integer" + ",";
    sql += "categoryId" + " " + "integer" + ",";
    sql += "orderI" + " " + "integer" + ",";
    sql += "products" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "discounts" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "subject" + " " + "varchar(256)" + ",";
    sql += "description" + " " + "varchar(256)" + ",";
    sql += "categoryId" + " " + "integer" + ",";
    sql += "orderId" + " " + "integer" + ",";
    sql += "discounts" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "attributeCategories" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    sql += "productId" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "attributes" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    sql += "value" + " " + "varchar(256)" + ",";
    sql += "attributeCategoryId" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "users" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    sql += "password" + " " + "varchar(256)" + ",";
    sql += "priviledge" + " " + "varchar(256)" + ",";
    sql += "userId" + " " + "integer" + ",";
    sql += "users" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "persons" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "firstName" + " " + "varchar(256)" + ",";
    sql += "lastName" + " " + "varchar(256)" + ",";
    sql += "personId" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "adresses" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "line1" + " " + "varchar(256)" + ",";
    sql += "line2" + " " + "varchar(256)" + ",";
    sql += "postcode" + " " + "integer" + ",";
    sql += "state" + " " + "varchar(256)" + ",";
    sql += "country" + " " + "varchar(256)" + ",";
    sql += "city" + " " + "varchar(256)" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    primaryKey = "primary key(";
    primaryKey += "id";
    primaryKey += ")";
    sql = "create table " + "OrderTable" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "status" + " " + "varchar(256)" + ",";
    sql += "creationDate" + " " + "integer" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    sql = "create table " + "Cart" + "(";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

    primaryKey = "";
    sql = "create table " + "Shop" + "(";
    sql += "id" + " " + "integer" + ",";
    sql += "name" + " " + "varchar(256)" + ",";
    if (primaryKey.length() == 0) {
      sql = sql.substring(0, sql.length() - 1);
    }
    sql += primaryKey;
    sql += ")";
    System.out.println(sql);
    stmt.execute(sql);

  }
  private static void constrainTables(Statement stmt) throws SQLException, ClassNotFoundException {
    String sql = "";

    sql = "alter table " + "categories" + " add constraint fk_" + "categories" + "_" + "categoryId";
    sql += " foreign key (" + "categoryId" + ") references " + "categories" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "categories" + " add constraint fk_" + "categories" + "_" + "categories";
    sql += " foreign key (" + "categories" + ") references " + "Shop" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "products" + " add constraint fk_" + "products" + "_" + "categoryId";
    sql += " foreign key (" + "categoryId" + ") references " + "categories" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "products" + " add constraint fk_" + "products" + "_" + "orderI";
    sql += " foreign key (" + "orderI" + ") references " + "OrderTable" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "products" + " add constraint fk_" + "products" + "_" + "products";
    sql += " foreign key (" + "products" + ") references " + "Cart" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "discounts" + " add constraint fk_" + "discounts" + "_" + "categoryId";
    sql += " foreign key (" + "categoryId" + ") references " + "categories" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "discounts" + " add constraint fk_" + "discounts" + "_" + "orderId";
    sql += " foreign key (" + "orderId" + ") references " + "OrderTable" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "discounts" + " add constraint fk_" + "discounts" + "_" + "discounts";
    sql += " foreign key (" + "discounts" + ") references " + "Cart" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "attributeCategories" + " add constraint fk_" + "attributeCategories" + "_" + "productId";
    sql += " foreign key (" + "productId" + ") references " + "products" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "attributes" + " add constraint fk_" + "attributes" + "_" + "attributeCategoryId";
    sql += " foreign key (" + "attributeCategoryId" + ") references " + "attributeCategories" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "users" + " add constraint fk_" + "users" + "_" + "userId";
    sql += " foreign key (" + "userId" + ") references " + "persons" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);
    sql = "alter table " + "users" + " add constraint fk_" + "users" + "_" + "users";
    sql += " foreign key (" + "users" + ") references " + "Shop" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);

    sql = "alter table " + "persons" + " add constraint fk_" + "persons" + "_" + "personId";
    sql += " foreign key (" + "personId" + ") references " + "adresses" + "(" + "id" + ")";
    System.out.println(sql);
    stmt.execute(sql);
  }

  private static void dropTables(Statement stmt) throws ClassNotFoundException, SQLException {
    String sql = "";
    sql = "drop table " + "categories" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "products" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "discounts" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "attributeCategories" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "attributes" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "users" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "persons" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "adresses" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "OrderTable" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "Cart" + " cascade constraints";
    stmt.executeUpdate(sql);

    sql = "drop table " + "Shop" + " cascade constraints";
    stmt.executeUpdate(sql);

  }

  public static void main(String[] args) throws ClassNotFoundException, SQLException {
    Statement stmt = DatabaseConnection.getConnection().createStatement();

    try {
      generateTables(stmt);
      constrainTables(stmt);
    } catch (Exception e) {
      e.printStackTrace();
    }
    stmt.close();

  }



}
