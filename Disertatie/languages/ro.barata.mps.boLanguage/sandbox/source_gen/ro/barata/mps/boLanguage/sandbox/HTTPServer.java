package ro.barata.mps.boLanguage.sandbox;

/*Generated by MPS */

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.nio.SelectChannelConnector;
import org.eclipse.jetty.servlet.ServletContextHandler;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;

public class HTTPServer {
  public static void main(String[] args) throws Exception {
    Server server = new Server();
    SelectChannelConnector connector = new SelectChannelConnector();
    connector.setHost("localhost");
    connector.setPort(8888);
    server.addConnector(connector);

    String path = HTTPServer.class.getClassLoader().getResource(HTTPServer.class.getName().replace(".", "/") + ".class").toString();
    path = path.substring(0, path.lastIndexOf("/"));

    ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
    context.setContextPath("/");

    DefaultServlet defaultServlet = new DefaultServlet();
    ServletHolder holder = new ServletHolder("default", defaultServlet);
    holder.setInitParameter("resourceBase", path);
    context.addServlet(holder, "/*");

    context.addServlet(new ServletHolder(new IndexServlet()), "/" + "index");
    context.addServlet(new ServletHolder(new NextPageServlet()), "/" + "nextPage");

    server.setHandler(context);
    server.start();
    server.join();

  }
}
